<!DOCTYPE html>
<html>
  <head>
    <title>101.1 MHz</title>
    <link rel="stylesheet" href="ctf.css" type="text/css">
    <script type="text/javascript">
/* RC4 symmetric cipher encryption/decryption
 * Copyright (c) 2006 by Ali Farhadi.
 * released under the terms of the Gnu Public License.
 * see the GPL for details.
 *
 * Email: ali[at]farhadi[dot]ir
 * Website: http://farhadi.ir/
 */
function rc4Encrypt(key, pt) {
    s = new Array();
    for (var i=0; i<256; i++) {
	s[i] = i;
    }
    var j = 0;
    var x;
    for (i=0; i<256; i++) {
	j = (j + s[i] + key.charCodeAt(i % key.length)) % 256;
	x = s[i];
	s[i] = s[j];
	s[j] = x;
    }
    i = 0;
    j = 0;
    var ct = '';
    for (var y=0; y<pt.length; y++) {
	i = (i + 1) % 256;
	j = (j + s[i]) % 256;
	x = s[i];
	s[i] = s[j];
	s[j] = x;
	ct += String.fromCharCode(pt.charCodeAt(y) ^ s[(s[i] + s[j]) % 256]);
    }
    return ct;
}

tokens = [
    "Vo%92%00%DE%EDR%E9%F5%B8%97v%D7%DA%EC%FB%E2%0AF%DE%DA%17%EC%0BF%3D",
    "%D0%C39fH%00%3D%FB%85xO1%EC%0DA%B0%B3%19YPhn%D0%0E%C4%04",
    "%E6%A9%B8%09%A6%F2%28%A3%F3/%10%AC%8D%3CK%082%FE%3E%D7%EA%1Es%3En",
    "Y%F8%0C%CD%ED%251%B5%1FM%C8%E8%DE%EC%7Fc%3AKy%AF%60%19O%03%7F%1C",
    "%DE%02%A7%3A%CD%90%FB%97b%C4%60%CE%CBS%CE%29%5BK%0A%C7%25%84J%B4*",
    "%3F%84G%10%A5%5DgjH%09%F1%A9%D5%A0rG%E7%D8%0B%15%89%24%A1%9Cx%C6",
    "Z%AE%16i%8F%1A%02%83Y%A9d%3CL%02%89%AA%9Bj6%CD%5C%12%FC%14%F5%12",
    "%18%F5%06d%C0%FC/%29%3D%DF%1F%1B1.%E4%E7Q%01%BD%5D%D6%13%F8w%25%02",
    "%F2%F2%D0%DB%F7U8%B2%AB%11%CA%60Ad%E2%E8N%5C%3C%D8%F5%10eM%D2%DD",
    "%B1.2%D4ZV%7B%C7m%0F%B6%AE%0F%05%05%8C%DBY%82%08y%A6%D6%5E%C4%C8",
];

otokens = [
    ["radio:50:xeneb-tisyz-bamox", "2381355233377"],
    ["radio:40:xekaf-fozem-zezox", "tactlessly"],
    ["radio:5:xukos-gimiv-zupex",  "archipelagos"],
    ["radio:50:xehih-gazap-zagox", "debagged"],
    ["radio:5:xukok-napyd-zurex",  "decoder"],
    ["radio:10:xehof-hucec-ruhux", "equivocate"],
    ["radio:10:xitim-pyvig-dakyx", "meningitis"],
    ["radio:50:xudab-hihed-senix", "meritocracy"],
    ["radio:10:xihez-sepyr-zytax", "penologist"],
    ["radio:60:xoheg-fivic-besax", "simulcasts"],
];

function quote(s) {
    return s.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
}

function check() {
    var a = document.getElementById("a").value;
    var o = document.getElementById("o");
    var n = 0;

    o.innerHTML = "";

    for (var i in tokens) {
        //o.innerHTML += "\"" + escape(rc4Encrypt(tokens[i][1], tokens[i][0])) + "\",\n";

        var t = unescape(tokens[i]);
        var d = rc4Encrypt(a, t);

        if (d.substr(0, 5) == "radio") {
            o.innerHTML += unescape(d) + "\n";
            n += 1;
        }
    }

    if (n) {
        o.innerHTML += "---\n" + n + " tokens decoded\n";
    } else {
        o.innerHTML = "Try again.";
    }

}
    </script>
  </head>
  <body>
    <h1>101.1 MHz</h1>

    <p>
      Tune to 101.1 MHz.
    </p>

    <form action="#" onsubmit="check();">
      If you think you've figured something out, enter it here:
      <input id="a">
      <input type="submit" value="check answer">
    </form>

    <pre id="o"></pre>
  </body>
</html>
